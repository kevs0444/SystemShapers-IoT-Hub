<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SystemShapers IoT Hub - Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles/dashboard.css">
</head>
<body data-theme="dark">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="brand-logo">
        <div class="logo-icon">S</div>
        <h1>SystemShapers IoT Hub</h1>
      </div>
      
      <div class="header-actions">
        <div class="theme-toggle" onclick="toggleTheme()">
          <span id="theme-icon">üåô</span>
        </div>
        
        <div class="user-profile">
          <div class="user-avatar" id="user-avatar">U</div>
          <div class="user-info">
            <h3 id="user-name">Loading...</h3>
            <p>Administrator</p>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Dashboard Content -->
  <main class="dashboard-container">
    <!-- Welcome Section -->
    <section class="dashboard-welcome">
      <h2>Welcome Back!</h2>
      <p>Here's what's happening with your IoT ecosystem today</p>
      <div class="status-badge">
        <span>‚úÖ</span>
        <span>All Systems Operational</span>
      </div>
    </section>

    <!-- Statistics Grid -->
    <section class="stats-grid">
      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-title">Connected Devices</div>
          <div class="stat-icon">üì±</div>
        </div>
        <div class="stat-value">24</div>
        <div class="stat-change positive">
          <span>‚ÜóÔ∏è</span>
          <span>+3 from last week</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-title">Data Points Today</div>
          <div class="stat-icon">üìä</div>
        </div>
        <div class="stat-value">1,247</div>
        <div class="stat-change positive">
          <span>‚ÜóÔ∏è</span>
          <span>+12% from yesterday</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-title">Active Automations</div>
          <div class="stat-icon">‚ö°</div>
        </div>
        <div class="stat-value">8</div>
        <div class="stat-change positive">
          <span>‚ÜóÔ∏è</span>
          <span>2 new this week</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-title">System Uptime</div>
          <div class="stat-icon">‚è±Ô∏è</div>
        </div>
        <div class="stat-value">99.9%</div>
        <div class="stat-change positive">
          <span>‚úÖ</span>
          <span>Excellent performance</span>
        </div>
      </div>
    </section>

    <!-- Quick Actions -->
    <section class="quick-actions">
      <h3>Quick Actions</h3>
      <div class="action-buttons">
        <button class="btn btn-primary" onclick="addDevice()">
          <span>‚ûï</span>
          Add New Device
        </button>
        <button class="btn btn-secondary" onclick="viewAnalytics()">
          <span>üìà</span>
          View Analytics
        </button>
        <button class="btn btn-secondary" onclick="manageAutomations()">
          <span>üîß</span>
          Manage Automations
        </button>
        <button class="btn btn-secondary" onclick="exportData()">
          <span>üì§</span>
          Export Data
        </button>
      </div>
    </section>

    <!-- Feature Grid -->
    <section class="feature-grid">
      <div class="feature-card" onclick="navigateToDevices()">
        <div class="feature-icon">üè†</div>
        <div class="feature-title">Device Management</div>
        <div class="feature-desc">
          Monitor, control, and configure all your connected IoT devices from a single interface. 
          View real-time status, update firmware, and manage device settings.
        </div>
        <a href="#" class="feature-action">
          Manage Devices
          <span>‚Üí</span>
        </a>
      </div>

      <div class="feature-card" onclick="navigateToAnalytics()">
        <div class="feature-icon">üìä</div>
        <div class="feature-title">Data Analytics</div>
        <div class="feature-desc">
          Gain insights from your IoT data with comprehensive analytics, custom dashboards, 
          and detailed reports to optimize your smart ecosystem.
        </div>
        <a href="#" class="feature-action">
          View Analytics
          <span>‚Üí</span>
        </a>
      </div>

      <div class="feature-card" onclick="navigateToAutomation()">
        <div class="feature-icon">ü§ñ</div>
        <div class="feature-title">Smart Automation</div>
        <div class="feature-desc">
          Create intelligent automation rules and workflows to make your devices work together 
          seamlessly based on conditions, schedules, and triggers.
        </div>
        <a href="#" class="feature-action">
          Setup Automation
          <span>‚Üí</span>
        </a>
      </div>

      <div class="feature-card" onclick="navigateToSettings()">
        <div class="feature-icon">‚öôÔ∏è</div>
        <div class="feature-title">System Settings</div>
        <div class="feature-desc">
          Customize your dashboard preferences, manage user accounts, configure notifications, 
          and adjust security settings for your IoT hub.
        </div>
        <a href="#" class="feature-action">
          Open Settings
          <span>‚Üí</span>
        </a>
      </div>

      <div class="feature-card" onclick="navigateToSecurity()">
        <div class="feature-icon">üîí</div>
        <div class="feature-title">Security Center</div>
        <div class="feature-desc">
          Monitor security events, manage device certificates, review access logs, 
          and ensure your IoT network remains secure and protected.
        </div>
        <a href="#" class="feature-action">
          Security Dashboard
          <span>‚Üí</span>
        </a>
      </div>

      <div class="feature-card" onclick="navigateToSupport()">
        <div class="feature-icon">üí¨</div>
        <div class="feature-title">Support & Help</div>
        <div class="feature-desc">
          Access documentation, troubleshooting guides, community forums, 
          and get technical support for your SystemShapers IoT Hub.
        </div>
        <a href="#" class="feature-action">
          Get Support
          <span>‚Üí</span>
        </a>
      </div>
    </section>

    <!-- Sign Out Section -->
    <section class="quick-actions">
      <h3>Account Management</h3>
      <div class="action-buttons">
        <button class="btn btn-danger" onclick="logout()">
          <span>üö™</span>
          Sign Out
        </button>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="dashboard-footer">
    <p class="footer-text">
      ¬© 2024 SystemShapers IoT Hub. All rights reserved. | 
      <a href="#" style="color: var(--accent-primary);">Privacy Policy</a> | 
      <a href="#" style="color: var(--accent-primary);">Terms of Service</a>
    </p>
  </footer>

  <!-- JavaScript -->
  <script type="module">
    import { auth } from "../scripts/firebase-config.js";
    import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";

    // Theme toggle functionality
    window.toggleTheme = function() {
      const currentTheme = document.body.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.body.setAttribute('data-theme', newTheme);
      
      const icon = document.getElementById("theme-icon");
      if (icon) {
        icon.textContent = newTheme === "dark" ? "üåô" : "‚òÄÔ∏è";
      }
    };

    // Check if user is logged in
    onAuthStateChanged(auth, (user) => {
      if (user) {
        // User is signed in
        document.getElementById("user-name").textContent = user.email || "User";
        
        // Set user avatar initial
        const email = user.email || "User";
        const initial = email.charAt(0).toUpperCase();
        document.getElementById("user-avatar").textContent = initial;
      } else {
        // User is signed out, redirect to login
        window.location.href = "login.html";
      }
    });

    // Logout function
    window.logout = async function() {
      try {
        await signOut(auth);
        alert("You have been signed out successfully.");
        window.location.href = "login.html";
      } catch (error) {
        console.error("Sign out error:", error);
        alert("Error signing out: " + error.message);
      }
    };

    // Navigation functions (placeholders for future implementation)
    window.navigateToDevices = function() {
      alert("Device Management - Coming Soon!");
    };

    window.navigateToAnalytics = function() {
      alert("Analytics Dashboard - Coming Soon!");
    };

    window.navigateToAutomation = function() {
      alert("Smart Automation - Coming Soon!");
    };

    window.navigateToSettings = function() {
      alert("System Settings - Coming Soon!");
    };

    window.navigateToSecurity = function() {
      alert("Security Center - Coming Soon!");
    };

    window.navigateToSupport = function() {
      alert("Support Center - Coming Soon!");
    };

    // Quick action functions (placeholders)
    window.addDevice = function() {
      alert("Add New Device - Coming Soon!");
    };

    window.viewAnalytics = function() {
      alert("View Analytics - Coming Soon!");
    };

    window.manageAutomations = function() {
      alert("Manage Automations - Coming Soon!");
    };

    window.exportData = function() {
      alert("Export Data - Coming Soon!");
    };
  </script>
</body>
</html>